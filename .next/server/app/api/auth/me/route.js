"use strict";(()=>{var e={};e.id=788,e.ids=[788],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},2781:e=>{e.exports=require("stream")},3837:e=>{e.exports=require("util")},5091:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>f,patchFetch:()=>h,requestAsyncStorage:()=>d,routeModule:()=>p,serverHooks:()=>x,staticGenerationAsyncStorage:()=>m});var n={};t.r(n),t.d(n,{GET:()=>l,dynamic:()=>c});var o=t(9303),i=t(8716),s=t(670),a=t(7070),u=t(2624);let c="force-dynamic";async function l(){let e=await (0,u.Gg)();return e?a.NextResponse.json({ok:!0,id:e.user.id,username:e.user.username,role:e.user.role}):a.NextResponse.json({ok:!1},{status:401})}let p=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/auth/me/route",pathname:"/api/auth/me",filename:"route",bundlePath:"app/api/auth/me/route"},resolvedPagePath:"/Users/mahadi/Desktop/MindBridge/src/app/api/auth/me/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:d,staticGenerationAsyncStorage:m,serverHooks:x}=p,f="/api/auth/me/route";function h(){return(0,s.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:m})}},2624:(e,r,t)=>{t.d(r,{qd:()=>g,Gg:()=>m,c_:()=>l,MH:()=>f,oT:()=>x,nu:()=>h,z:()=>d,Gv:()=>p});let n=require("argon2");var o=t.n(n),i=t(1482),s=t.n(i),a=t(1615),u=t(728);let c="mb_token";async function l(e){return o().hash(e)}async function p(e,r){return o().verify(e,r)}function d(e){let r=process.env.JWT_SECRET;return s().sign(e,r,{expiresIn:"7d"})}async function m(){let e=(0,a.cookies)(),r=e.get(c)?.value;if(!r)return null;let t=function(e){try{return s().verify(e,process.env.JWT_SECRET)}catch{return null}}(r);if(!t)return null;let n=await u._.user.findUnique({where:{id:t.sub}});return n?{user:n,role:n.role,token:r}:null}async function x(){let e=await m();if(!e)throw Error("Unauthorized");return e}async function f(e){let r=await x();if(r.user.role!==e)throw Error("Forbidden");return r}function h(e,r){e.cookies.set(c,r,{httpOnly:!0,sameSite:"lax",secure:!0,path:"/",maxAge:604800})}function g(e){e.cookies.delete(c)}},728:(e,r,t)=>{t.d(r,{_:()=>o});let n=require("@prisma/client"),o=global.prisma??new n.PrismaClient({log:["error"]})}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[948,972,261],()=>t(5091));module.exports=n})();